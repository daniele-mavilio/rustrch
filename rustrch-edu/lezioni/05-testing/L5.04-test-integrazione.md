## Teoria

I test di integrazione verificano che diversi componenti del sistema funzionino correttamente insieme. A differenza dei test unitari, che isolano singole funzioni, i test di integrazione esaminano l'interazione tra più moduli, come il crawler, l'indicizzatore e il motore di ricerca. Questo tipo di test è essenziale per garantire che il flusso di dati tra le varie parti del motore di ricerca sia fluido e privo di errori.

Un test di integrazione tipico potrebbe simulare un processo completo: il crawler estrae dati da una fonte, l'indicizzatore li elaborare e li memorizza, e il motore di ricerca li recupera in risposta a una query. Questo approccio aiuta a identificare problemi che potrebbero non emergere nei test unitari, come incompatibilità tra moduli o errori di comunicazione.

## Esempio

Consideriamo un test di integrazione per il motore di ricerca. Il test potrebbe iniziare con il crawler che estrae dati da una pagina web simulata, quindi l'indicizzatore li elaborare e li memorizza in un database temporaneo. Infine, il motore di ricerca esegue una query per verificare che i dati siano stati correttamente indicizzati e recuperati. Questo processo simula un flusso reale di lavoro e aiuta a garantire che il sistema funzioni come previsto.

## Pseudocodice

```rust
// Definizione di un test di integrazione per il motore di ricerca
#[test]
fn test_integrazione_motore_ricerca() {
    // Setup: Crea un ambiente di test con un database temporaneo
    let db = Database::new("test_db.sqlite");
    let crawler = Crawler::new();
    let indexer = Indexer::new(db);
    let search_engine = SearchEngine::new(db);

    // Esegui il crawling di una pagina web simulata
    let url = "http://example.com/test";
    let content = crawler.crawl(url).unwrap();

    // Indicizza il contenuto estratto
    indexer.index(content).unwrap();

    // Esegui una query di ricerca
    let query = "test";
    let results = search_engine.search(query).unwrap();

    // Verifica che i risultati siano corretti
    assert!(!results.is_empty());
    assert!(results.contains("test"));

    // Teardown: Pulizia del database temporaneo
    db.cleanup();
}
```

## Risorse

- [Documentazione ufficiale di Rust su test di integrazione](https://doc.rust-lang.org/book/ch11-03-test-organization.html)
- [Guida ai test di integrazione con Rust](https://doc.rust-lang.org/rust-by-example/testing/integration_testing.html)
- [Best practices per i test di integrazione](https://docs.rs/tokio-test/)

## Esercizio

Scrivi un test di integrazione per verificare che il crawler e l'indicizzatore funzionino correttamente insieme. Il test dovrebbe:
1. Creare un database temporaneo.
2. Eseguire il crawling di una pagina web simulata.
3. Indicizzare il contenuto estratto.
4. Verificare che i dati siano stati correttamente memorizzati nel database.
5. Pulire il database temporaneo al termine del test.

Traccia di soluzione:
- Utilizza un database SQLite temporaneo per il test.
- Simula una pagina web con contenuto noto.
- Verifica che l'indicizzatore abbia memorizzato correttamente i dati.
- Assicurati che il database venga pulito al termine del test.
